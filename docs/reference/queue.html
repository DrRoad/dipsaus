<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create R object queue. — queue • dipsaus</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create R object queue. — queue" />
<meta property="og:description" content="Provides five types of queue that fit in different use cases." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dipsaus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/shiny_customized_widgets.html">Shiny Customized Widgets</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dipterix/dipsaus">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create R object queue.</h1>
    <small class="dont-index">Source: <a href='https://github.com/dipterix/dipsaus/blob/master/R/queue-s3.R'><code>R/queue-s3.R</code></a></small>
    <div class="hidden name"><code>queue.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Provides five types of queue that fit in different use cases.</p>
    </div>

    <pre class="usage"><span class='fu'>session_queue</span>(<span class='kw'>map</span> <span class='kw'>=</span> <span class='kw pkg'>fastmap</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/fastmap/man/fastmap.html'>fastmap</a></span>())

<span class='fu'>rds_queue</span>(<span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span>())

<span class='fu'>text_queue</span>(<span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span>())

<span class='fu'>qs_queue</span>(<span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span>())

<span class='fu'>redis_queue</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='fu'>rand_string</span>())</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>map</th>
      <td><p>a <code><a href='https://rdrr.io/pkg/fastmap/man/fastmap.html'>fastmap::fastmap()</a></code> list</p></td>
    </tr>
    <tr>
      <th>path</th>
      <td><p>directory path where queue data should be stored</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>character, queue name. If queue name are the same, the data
will be shared.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An <code>R6</code> instance that inherits <code><a href='AbstractQueue.html'>AbstractQueue</a></code></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>There are five types of queue implemented. They all inherit class
<code><a href='AbstractQueue.html'>AbstractQueue</a></code>. There are several differences in
use case scenarios and they backend implementations.</p>
<dl class='dl-horizontal'>
<dt><code>session_queue</code></dt><dd><p>A session queue takes a <code><a href='https://rdrr.io/pkg/fastmap/man/fastmap.html'>fastmap</a></code> object. All objects are stored in
current R session. This means you cannot access the queue from other process
nor parent process. The goal of this queue is to share the data across
different environments and to store global variables, as long as they share
the same map object. If you are looking for queues that can be shared
by different processes, check the rest queue types.</p></dd>
<dt><code>rds_queue</code></dt><dd><p>A 'RDS' queue uses file system to store values. The values are stored
separately in '.rds' files. Compared to session queues, 'RDS' queue can be
shared across different R process. However, because each value is stored
as a file, cleaning a queue would be slow, hence it's recommended to store
large files in <code>rds_queue</code>. If the value is not large in RAM,
<code>text_queue</code> and <code>redis_queue</code> are recommended.</p></dd>
<dt><code>qs_queue</code></dt><dd><p>A 'qs' queue uses package 'qs' as backend. This queue is very similar to
<code>rds_queue</code>, but is especially designed for large values. For example,
pushing 1GB data to <code>qs_queue</code> will be 100 times faster than using
<code>rds_queue</code>, and <code>text_queue</code> will almost fail. However, compared
to <code>rds_queue</code> the stored data cannot be normally read by R as they
are compressed binary files. And <code>qs_queue</code> is heavier than
<code>text_queue</code>.</p></dd>
<dt><code>text_queue</code></dt><dd><p>A 'text' queue uses file system to store values. Similar to <code>rds_queue</code>,
it can be stored across multiple processes as long as the queues share the
same file directory. Compared to <code>rds_queue</code>, <code>text_queue</code>
serialize values as strings and stores them as a text table. It's much
lighter but limited. For example, all other queue types can store environment
and functions. Though <code>text_queue</code> can also store complicated structures,
The speed is much slower (could freeze the whole process). Therefore, it's
highly recommended to use <code>redis_queue</code>, <code>qs_queue</code>, and
<code>rds_queue</code> if speed is not the major concern.</p></dd>
<dt><code>redis_queue</code></dt><dd><p>A 'Redis' queue uses free open source software `Redis` and R package
'RcppRedis' as backend. Compared to session queue, 'Redis' queue can be
shared across sessions. Compared to 'text' and 'rds' queues, 'Redis' queue
stores data in memory, meaning a potential of significant speed ups. To use
<code>redis_queue</code>, you need to install `Redis` on your computer.
<ul>
<li><p>On Mac: use `<code>brew install redis</code>` to install and
    `<code>brew services start redis</code>` to start the service</p></li>
<li><p>On Linux: use `<code>sudo apt-get install redis-server</code>` to install
    and `<code>sudo systemctl enable redis-server.service</code>` to start the
    service</p></li>
<li><p>On Windows: Download from
    <a href='https://github.com/dmajkic/redis/downloads'>https://github.com/dmajkic/redis/downloads</a> and double click
    'redis-server.exe'</p></li>
</ul></p></dd>

</dl>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># ----------------------Basic Usage ----------------------</span>

<span class='co'># Define a path to your queue.</span>
<span class='no'>queue</span> <span class='kw'>&lt;-</span> <span class='fu'>qs_queue</span>(<span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span>())

<span class='co'># Reset</span>
<span class='no'>queue</span>$<span class='fu'>reset</span>()</div><div class='output co'>#&gt; list()</div><div class='input'>
<span class='co'># Check if the queue is corrupted.</span>
<span class='no'>queue</span>$<span class='fu'>validate</span>()

<span class='co'># You have not pushed any messages yet.</span>
<span class='co'># Let's say two parallel processes (A and B) are sharing this queue.</span>
<span class='co'># Process A sends Process B some messages.</span>
<span class='co'># You can only send character vectors.</span>
<span class='no'>queue</span>$<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>()</div><div class='output co'>#&gt; [1] time    key     hash    message
#&gt; &lt;0 rows&gt; (or 0-length row.names)</div><div class='input'>
<span class='co'># Start push</span>
<span class='co'># Push a normal message</span>
<span class='no'>queue</span>$<span class='fu'>push</span>(<span class='kw'>value</span> <span class='kw'>=</span> <span class='st'>'Do this'</span>, <span class='kw'>message</span> <span class='kw'>=</span> <span class='st'>'hello'</span>)

<span class='co'># Push a quo</span>
<span class='no'>v</span> <span class='kw'>&lt;-</span> <span class='fl'>16</span>
<span class='no'>queue</span>$<span class='fu'>push</span>(<span class='kw'>value</span> <span class='kw'>=</span> <span class='kw pkg'>rlang</span><span class='kw ns'>::</span><span class='fu'><a href='https://rlang.r-lib.org/reference/quotation.html'>quo</a></span>({
  <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(!!<span class='no'>v</span>)
}), <span class='kw'>message</span> <span class='kw'>=</span> <span class='st'>'eval'</span>)

<span class='co'># Push a large object</span>
<span class='no'>queue</span>$<span class='fu'>push</span>(<span class='kw'>value</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>100000</span>), <span class='kw'>message</span> <span class='kw'>=</span> <span class='st'>'sum'</span>)

<span class='co'># Push only message</span>
<span class='no'>queue</span>$<span class='fu'>push</span>(<span class='kw'>value</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>message</span> <span class='kw'>=</span> <span class='st'>'stop'</span>)

<span class='co'># Check queued messages.</span>
<span class='co'># The `time` is a formatted character string from `Sys.time()`</span>
<span class='co'># indicating when the message was pushed. `key` is unique key</span>
<span class='co'># generated from `time`, `value` and queue internal `ID`</span>
<span class='no'>queue</span>$<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>()</div><div class='output co'>#&gt;                             time                              key
#&gt; 1 2019-11-13 22:27:12.382745 CST 80f79e9f6800d19534b17bc894f8aef3
#&gt; 2 2019-11-13 22:27:12.395526 CST 25ba9979f0661c51a47e5a37510ba669
#&gt; 3 2019-11-13 22:27:12.404824 CST f6855282c901943a71f2304fb8c79367
#&gt; 4 2019-11-13 22:27:12.425120 CST 737e15568691321e3be0fce03a1890ce
#&gt;                               hash message
#&gt; 1 80f79e9f6800d19534b17bc894f8aef3   hello
#&gt; 2 25ba9979f0661c51a47e5a37510ba669    eval
#&gt; 3 f6855282c901943a71f2304fb8c79367     sum
#&gt; 4 737e15568691321e3be0fce03a1890ce    stop</div><div class='input'>
<span class='co'># Number of messages in the queue.</span>
<span class='no'>queue</span>$<span class='no'>count</span></div><div class='output co'>#&gt; [1] 4</div><div class='input'>
<span class='co'># Number of messages that were ever queued.</span>
<span class='no'>queue</span>$<span class='no'>total</span></div><div class='output co'>#&gt; [1] 4</div><div class='input'>
<span class='co'># Return and remove the first messages that were added.</span>
<span class='no'>queue</span>$<span class='fu'>pop</span>(<span class='fl'>2</span>)</div><div class='output co'>#&gt; [[1]]
#&gt; [[1]]$time
#&gt; [1] "2019-11-13 22:27:12.382745 CST"
#&gt; 
#&gt; [[1]]$key
#&gt; [1] "80f79e9f6800d19534b17bc894f8aef3"
#&gt; 
#&gt; [[1]]$hash
#&gt; [1] "80f79e9f6800d19534b17bc894f8aef3"
#&gt; 
#&gt; [[1]]$message
#&gt; [1] "hello"
#&gt; 
#&gt; [[1]]$value
#&gt; [1] "Do this"
#&gt; 
#&gt; 
#&gt; [[2]]
#&gt; [[2]]$time
#&gt; [1] "2019-11-13 22:27:12.395526 CST"
#&gt; 
#&gt; [[2]]$key
#&gt; [1] "25ba9979f0661c51a47e5a37510ba669"
#&gt; 
#&gt; [[2]]$hash
#&gt; [1] "25ba9979f0661c51a47e5a37510ba669"
#&gt; 
#&gt; [[2]]$message
#&gt; [1] "eval"
#&gt; 
#&gt; [[2]]$value
#&gt; <span style='font-weight: bold;'>&lt;quosure&gt;</span><span>
#&gt; expr: </span><span style='color: #0000BB;'>^{
#&gt;           sqrt(16)
#&gt;         }</span><span>
#&gt; env:  </span><span style='color: #0000BB;'>0x7f832a15c3a8</span><span>
#&gt; 
#&gt; </div><div class='input'>
<span class='co'># Number of messages in the queue.</span>
<span class='no'>queue</span>$<span class='no'>count</span></div><div class='output co'>#&gt; [1] 2</div><div class='input'>
<span class='co'># List what's left</span>
<span class='no'>queue</span>$<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>()</div><div class='output co'>#&gt;                             time                              key
#&gt; 1 2019-11-13 22:27:12.404824 CST f6855282c901943a71f2304fb8c79367
#&gt; 2 2019-11-13 22:27:12.425120 CST 737e15568691321e3be0fce03a1890ce
#&gt;                               hash message
#&gt; 1 f6855282c901943a71f2304fb8c79367     sum
#&gt; 2 737e15568691321e3be0fce03a1890ce    stop</div><div class='input'>
<span class='no'>val1</span> <span class='kw'>&lt;-</span> <span class='no'>queue</span>$<span class='fu'>pop</span>()
<span class='no'>val2</span> <span class='kw'>&lt;-</span> <span class='no'>queue</span>$<span class='fu'>pop</span>()

<span class='co'># Destroy the queue's files altogether.</span>
<span class='no'>queue</span>$<span class='fu'>destroy</span>()

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
  <span class='co'># Once destroyed, validate will raise error</span>
  <span class='no'>queue</span>$<span class='fu'>validate</span>()
}
<span class='co'># ----------------------Cross-Process Usage ----------------------</span>

<span class='co'># Cross session example</span>

<span class='no'>queue</span> <span class='kw'>&lt;-</span> <span class='fu'>text_queue</span>()

<span class='co'># In another process</span>
<span class='kw pkg'>future</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/future/man/future.html'>future</a></span>({
  <span class='no'>process_pid</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.getpid.html'>Sys.getpid</a></span>()
  <span class='no'>queue</span>$<span class='fu'>push</span>(<span class='no'>process_pid</span>)
}) <span class='kw'>-&gt;</span> <span class='no'>f</span>

<span class='co'># In current process, get pid</span>
<span class='co'># wait 0.2 seconds, making sure the queue has at least an item</span>
<span class='fu'><a href='https://rdrr.io/r/base/Sys.sleep.html'>Sys.sleep</a></span>(<span class='fl'>0.2</span>)
<span class='no'>message</span> <span class='kw'>=</span> <span class='no'>queue</span>$<span class='fu'>pop</span>()
<span class='no'>message</span><span class='kw'>[[</span><span class='fl'>1</span>]]</div><div class='output co'>#&gt; $time
#&gt; [1] "2019-11-13 22:27:12.567429 CST"
#&gt; 
#&gt; $key
#&gt; [1] "9b73c53f3b15501f0e8d96dd8d1fbe8b"
#&gt; 
#&gt; $hash
#&gt; [1] "A\n3\n198145\n197888\n5\nUTF-8\n13\n1\n52404"
#&gt; 
#&gt; $message
#&gt; [1] ""
#&gt; 
#&gt; $value
#&gt; [1] 52404
#&gt; </div><div class='input'>
<span class='co'># ----------------------Shiny Example ----------------------</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>shiny</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>promises</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dipsaus</span>)

<span class='no'>ui</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/fluidPage.html'>fluidPage</a></span>(
  <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/fluidPage.html'>fluidRow</a></span>(
    <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/column.html'>column</a></span>(
      <span class='fl'>12</span>,
      <span class='fu'><a href='actionButtonStyled.html'>actionButtonStyled</a></span>(<span class='st'>'do'</span>, <span class='st'>'Launch Process'</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>'primary'</span>),
      <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/builder.html'>hr</a></span>(),
      <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/textOutput.html'>textOutput</a></span>(<span class='st'>'text'</span>)
    )
  )
)
<span class='no'>server</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>input</span>, <span class='no'>output</span>, <span class='no'>session</span>) {
  <span class='fu'><a href='make_forked_clusters.html'>make_forked_clusters</a></span>()
  <span class='no'>env</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>environment</a></span>()
  <span class='no'>progress</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
  <span class='no'>queue</span> <span class='kw'>&lt;-</span> <span class='fu'>rds_queue</span>()
  <span class='no'>timer</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/reactiveTimer.html'>reactiveTimer</a></span>(<span class='fl'>50</span>)
  <span class='no'>local_data</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/reactiveValues.html'>reactiveValues</a></span>(<span class='kw'>text</span> <span class='kw'>=</span> <span class='st'>''</span>)
  <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/observe.html'>observe</a></span>({
    <span class='fu'>timer</span>()
    <span class='no'>message</span> <span class='kw'>=</span> <span class='no'>queue</span>$<span class='fu'>pop</span>()
    <span class='kw'>if</span>(<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>message</span>)){
      <span class='no'>instruction</span> <span class='kw'>=</span> <span class='no'>message</span><span class='kw'>[[</span><span class='fl'>1</span>]]$<span class='no'>value</span>
      <span class='fu'><a href='eval_dirty.html'>eval_dirty</a></span>(<span class='no'>instruction</span>, <span class='kw'>env</span> <span class='kw'>=</span> <span class='no'>env</span>)
    }
  })

  <span class='no'>output</span>$<span class='no'>text</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/renderText.html'>renderText</a></span>({
    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>local_data</span>$<span class='no'>text</span>)
    <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='no'>local_data</span>$<span class='no'>text</span>)
  })

  <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/observeEvent.html'>observeEvent</a></span>(<span class='no'>input</span>$<span class='no'>do</span>, {
    <span class='fu'><a href='updateActionButtonStyled.html'>updateActionButtonStyled</a></span>(<span class='no'>session</span>, <span class='st'>'do'</span>, <span class='kw'>disabled</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
    <span class='kw'>if</span>(!<span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span>(<span class='no'>progress</span>)){
      <span class='no'>progress</span>$<span class='fu'><a href='https://rdrr.io/r/base/connections.html'>close</a></span>()
    }
    <span class='no'>progress</span> <span class='kw'>&lt;&lt;-</span> <span class='fu'><a href='progress2.html'>progress2</a></span>(<span class='st'>'Analysis [A]'</span>, <span class='kw'>max</span> <span class='kw'>=</span> <span class='fl'>10</span>)

    <span class='kw pkg'>future</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/future/man/future.html'>future</a></span>({
      <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='kw'>function</span>(<span class='no'>ii</span>){
        <span class='no'>queue</span>$<span class='fu'>push</span>(<span class='kw pkg'>rlang</span><span class='kw ns'>::</span><span class='fu'><a href='https://rlang.r-lib.org/reference/quotation.html'>quo</a></span>(
          <span class='no'>progress</span>$<span class='fu'>inc</span>(!!<span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span>(<span class='st'>'Processing %d'</span>, <span class='no'>ii</span>))
        ))
        <span class='fu'><a href='https://rdrr.io/r/base/Sys.sleep.html'>Sys.sleep</a></span>(<span class='fl'>0.2</span>)
      })
      <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Sys.getpid.html'>Sys.getpid</a></span>())
    }) <span class='kw'>%...&gt;%</span> (<span class='kw'>function</span>(<span class='no'>v</span>){
      <span class='no'>queue</span>$<span class='fu'>push</span>(<span class='kw pkg'>rlang</span><span class='kw ns'>::</span><span class='fu'><a href='https://rlang.r-lib.org/reference/quotation.html'>quo</a></span>({
        <span class='no'>progress</span>$<span class='fu'><a href='https://rdrr.io/r/base/connections.html'>close</a></span>()
        <span class='fu'><a href='updateActionButtonStyled.html'>updateActionButtonStyled</a></span>(<span class='no'>session</span>, <span class='st'>'do'</span>, <span class='kw'>disabled</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
      }))
      <span class='no'>queue</span>$<span class='fu'>push</span>(<span class='kw pkg'>rlang</span><span class='kw ns'>::</span><span class='fu'><a href='https://rlang.r-lib.org/reference/quotation.html'>quo</a></span>({
        <span class='no'>local_data</span>$<span class='no'>text</span> <span class='kw'>=</span> !!<span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span>(<span class='st'>'Finished in process (PID): %s'</span>, <span class='no'>v</span>)
      }))
    })
    <span class='kw'>NULL</span>
  }, <span class='kw'>ignoreInit</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

  <span class='no'>session</span>$<span class='fu'><a href='https://rdrr.io/pkg/shiny/man/onFlush.html'>onSessionEnded</a></span>(<span class='kw'>function</span>(){
    <span class='no'>queue</span>$<span class='fu'>destroy</span>()
  })
}

<span class='kw'>if</span>( <span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span>() ){
  <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/shinyApp.html'>shinyApp</a></span>(<span class='no'>ui</span>, <span class='no'>server</span>)
}</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zhengjia Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


